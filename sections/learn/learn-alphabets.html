<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Learn English Letters - A to Z (English + Hindi)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Segoe UI', sans-serif; background:#fefefe; padding:20px; text-align:center; }
    h1 { color:#1976d2; margin-bottom:8px; }
    .letters-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(90px,1fr)); gap:14px; max-width:980px; margin:18px auto; }
    .letter-card { background:#bbdefb; border-radius:12px; padding:12px; font-size:22px; font-weight:700; color:#0d47a1; box-shadow:0 4px 6px rgba(0,0,0,0.08); cursor:pointer; transition:transform .12s, background .12s; display:flex; flex-direction:column; align-items:center; justify-content:center; position:relative; min-height:96px; }
    .letter-card:active { transform:scale(.98); }
    .letter-icon { font-size:34px; margin-bottom:6px; }
    .icon-name { font-size:13px; color:#0d47a1; margin-top:6px; }
    .speaker { position:absolute; right:10px; top:8px; font-size:18px; opacity:.9; }
    @media(max-width:600px){ .letter-card { font-size:18px; padding:8px; min-height:84px } .letter-icon{font-size:28px} .icon-name{font-size:12px} }
  </style>
</head>
<body>

  <h1>üéì Learn English Letters (A‚ÄìZ)</h1>
  <p style="color:#333; margin-top:0; margin-bottom:8px;">Tap any card ‚Äî plays <strong>English + Hindi</strong> (falls back to TTS if MP3 absent)</p>

  <div class="letters-grid" id="grid"></div>

  <div class="text-center mt-4">
    <a href="learn.html" class="btn btn-secondary">‚¨ÖÔ∏è Back</a>
  </div>

  <script>
    // Data for A-Z: letter, emoji, english example, hindi translation, filename
    const LETTERS = [
      ['A','üçé','A for Apple','‡§∏‡•á‡§¨','a.mp3'],
      ['B','‚öΩ','B for Ball','‡§ó‡•á‡§Ç‡§¶','b.mp3'],
      ['C','üê±','C for Cat','‡§¨‡§ø‡§≤‡•ç‡§≤‡•Ä','c.mp3'],
      ['D','üê∂','D for Dog','‡§ï‡•Å‡§§‡•ç‡§§‡§æ','d.mp3'],
      ['E','üêò','E for Elephant','‡§π‡§æ‡§•‡•Ä','e.mp3'],
      ['F','üêü','F for Fish','‡§Æ‡§õ‡§≤‡•Ä','f.mp3'],
      ['G','üêê','G for Goat','‡§¨‡§ï‡§∞‡•Ä','g.mp3'],
      ['H','üê¥','H for Horse','‡§ò‡•ã‡§°‡§º‡§æ','h.mp3'],
      ['I','üç¶','I for Ice Cream','‡§Ü‡§á‡§∏‡§ï‡•ç‡§∞‡•Ä‡§Æ','i.mp3'],
      ['J','ü•§','J for Juice','‡§ú‡•Ç‡§∏','j.mp3'],
      ['K','ü™Å','K for Kite','‡§™‡§§‡§Ç‡§ó','k.mp3'],
      ['L','ü¶Å','L for Lion','‡§∂‡•á‡§∞','l.mp3'],
      ['M','ü•≠','M for Mango','‡§Ü‡§Æ','m.mp3'],
      ['N','ü™π','N for Nest','‡§ò‡•ã‡§Ç‡§∏‡§≤‡§æ','n.mp3'],
      ['O','üçä','O for Orange','‡§∏‡§Ç‡§§‡§∞‡§æ','o.mp3'],
      ['P','ü¶ú','P for Parrot','‡§§‡•ã‡§§‡§æ','p.mp3'],
      ['Q','üëë','Q for Queen','‡§∞‡§æ‡§®‡•Ä','q.mp3'],
      ['R','üêá','R for Rabbit','‡§ñ‡§∞‡§ó‡•ã‡§∂','r.mp3'],
      ['S','‚òÄÔ∏è','S for Sun','‡§∏‡•Ç‡§∞‡§ú','s.mp3'],
      ['T','üêØ','T for Tiger','‡§¨‡§æ‡§ò','t.mp3'],
      ['U','‚òÇÔ∏è','U for Umbrella','‡§õ‡§æ‡§§‡§æ','u.mp3'],
      ['V','üöê','V for Van','‡§µ‡•à‡§®','v.mp3'],
      ['W','‚åö','W for Watch','‡§ò‡§°‡§º‡•Ä','w.mp3'],
      ['X','üéº','X for Xylophone','‡§ú‡§º‡§æ‡§Ø‡§≤‡•ã‡§´‡§º‡•ã‡§®','x.mp3'],
      ['Y','üêÇ','Y for Yak','‡§Ø‡§æ‡§ï','y.mp3'],
      ['Z','ü¶ì','Z for Zebra','‡§ú‡§º‡•á‡§¨‡§∞‡§æ','z.mp3']
    ];

    const grid = document.getElementById('grid');

    // build cards
    LETTERS.forEach(([letter,emoji,eng,hin,filename])=>{
      const card = document.createElement('div');
      card.className = 'letter-card';
      card.innerHTML = `
        <div class="speaker" title="Play audio">üîä</div>
        <div class="letter-icon">${emoji}</div>
        <div style="font-size:32px; line-height:1">${letter}</div>
        <div class="icon-name">${eng} ‚Äî ${hin}</div>
      `;
      // click handler: tries to play mp3 first, falls back to TTS
      card.addEventListener('click', async (e)=>{
        e.stopPropagation();
        await playBilingualAudio(filename, eng + ' ‚Äî ' + hin);
      });
      grid.appendChild(card);
    });

    // Try to load audio file from audio/<filename>. If it fails, use SpeechSynthesis fallback.
    async function playBilingualAudio(filename, fallbackText) {
      const audioUrl = `audio/${filename}`; // user may add real mp3s here
      try {
        // try fetch HEAD to see if file exists (works in same origin)
        const resp = await fetch(audioUrl, { method: 'HEAD' });
        if (resp.ok) {
          // browser can load file ‚Äî play via <audio>
          playAudioElement(audioUrl);
          return;
        }
      } catch (err) {
        // fetch may fail due to CORS or not found - we'll fallback to TTS
      }
      // fallback: use SpeechSynthesis for bilingual output
      speakBilingual(fallbackText);
    }

    function playAudioElement(src) {
      const a = new Audio(src);
      // try to play (some browsers require user gesture ‚Äî we are in click handler)
      a.play().catch(err=>{
        // if playback fails, fallback to TTS
        speakBilingualFromFilename(src);
      });
    }

    // Build bilingual utterance: English (en-US), then short pause, then Hindi (hi-IN)
    function speakBilingual(textCombined) {
      // textCombined expected like: "A for Apple ‚Äî ‡§∏‡•á‡§¨"
      const parts = textCombined.split('‚Äî').map(p=>p.trim());
      const synth = window.speechSynthesis;
      if (!synth) return; // nothing we can do

      // first part (English)
      if (parts[0]) {
        const u1 = new SpeechSynthesisUtterance(parts[0]);
        u1.lang = 'en-US';
        u1.rate = 0.95;
        synth.speak(u1);
      }
      // small pause by using a silent utterance (not widely supported) or queue Hindi after short timeout
      if (parts[1]) {
        // queue after a small delay so it doesn't overlap
        setTimeout(()=>{
          const u2 = new SpeechSynthesisUtterance(parts[1]);
          // choose Hindi voice if available; fallback to default
          u2.lang = 'hi-IN';
          u2.rate = 0.95;
          window.speechSynthesis.speak(u2);
        }, 650); // 650ms pause
      }
    }

    // If playAudioElement failed, try to extract filename to fallback text
    function speakBilingualFromFilename(src) {
      // try derive letter key from filename, otherwise generic fallback
      const name = src.split('/').pop().split('.')[0].toLowerCase();
      const idx = 'abcdefghijklmnopqrstuvwxyz'.indexOf(name);
      const fallback = LETTERS[idx] ? (LETTERS[idx][2] + ' ‚Äî ' + LETTERS[idx][3]) : 'Letter audio';
      speakBilingual(fallback);
    }

    // Optional: prevent overlapping TTS by cancelling before speaking
    // (already handled by browser's queue, but we can cancel)
    document.addEventListener('click', () => {
      // keep default behavior: do not cancel on other clicks to allow short queue
    });
  </script>
</body>
</html>
